function BuildBaseUrl(){var t=window.location.origin,n;return window.location.origin||window.location.origin||(t=window.location.protocol+"//"+window.location.hostname+(window.location.port?":"+window.location.port:"")),n=t+"/",window.location.pathname.toLowerCase().indexOf("ft.oda.web")>-1&&(n=n+"FT.ODA.WEB/"),n}function handleContainerBody(){var t=$(window).height(),n=$(window).width(),i=(n-241)/n*100-8;$(".containerBody").css("min-height",t-183+"px");$(".resultContainer").css("width",i+"%")}function containerImage(){$(".newContentSkov").css("max-height")=="0px"&&$(".newContentClouds").css("max-height")=="0px"?setTimeout(function(){$(".newContentSkov").css("max-height","200px")},1e3):$(".newContentSkov").css("max-height")=="200px"?($(".newContentSkov").css("max-height","0px"),setTimeout(function(){$(".newContentClouds").css("max-height","200px")},1e3)):$(".newContentClouds").css("max-height")=="200px"&&($(".newContentSkov").css("max-height","0px"),$(".newContentClouds").css("max-height","0px"))}function HideRequestInformation(){$(".noDataFound").hide();$(".errorInApplication").hide()}function ResetSearchValues(){$(".resultArea").empty();$("#keyValueToSearch").val("");$("#newValueToSearch").removeAttr("checked");$("#dateTimeLastSearch").text("");$(".queryResultText").text("");$(".filterArea").hide(100);$("#searchPropertySearchValue").val("")}function ShowTheAjaxLoader(){var n=Math.max(0,$(window).height()/2+$(window).scrollTop()),t=Math.max(0,$(window).width()/2+$(window).scrollLeft());$("#ajaxLoader").css("top",n+"px");$("#ajaxLoader").css("left",t+"px");$("#ajaxLoader").show()}function GetFilterRadioValue(){return $("input:radio[name=FilterRadio]:checked").val()}function GetNavigationPropertiesForEntity(n,t){var f=BuildBaseUrl(),u,i,r;n&&ResetSearchValues();u=$("#freeSearch :selected").attr("id");i=f+"Home/GetNavigationPropertiesForEntity?entity="+u;i=encodeURI(i);r=[];$.ajax({url:i,type:"GET",success:function(n){for(var i=0;i<n.Navigations.length;i++)r.push(n.Navigations[i]);DisplayNavigationProp(r);t&&GetDataFromNavigationProp()},error:function(){}})}function GetPropertiesForEntity(n){var i=$("#freeSearch option:selected").attr("id"),r=BuildBaseUrl(),t,u;n&&ResetSearchValues();t=r+"Home/GetPropertiesForEntity?entity="+i;t=encodeURI(t);u=[];$.ajax({url:t,type:"GET",success:function(n){DisplayProperties(n)},error:function(){}})}function Search(n,t,i){var f=$("#freeSearch option:selected").val(),r;if($("#searchPropertyValueList").removeClass("errorColor"),r=GetCorrectUrl(f),t=="key")CheckKeyValue(!1)&&GetRequest(r+GetCorrectExpandProperty($("#keyValueToSearch").val(),n,i));else{if($("#newValueToSearch").is(":checked"))r=GenerateGetNewUrl(r);else if($("#searchPropertySearchValue").val()!=""){var e=$("#searchPropertySearchValue").val(),o=$("#propertyList option:selected").attr("id"),u=$("#propertyList option:selected").attr("data-item");if(u!=undefined&&u!="")r=GenerateGetNewFilterUrl(r,o,u,e);else{$("#searchPropertyValueList").addClass("errorColor");return}}else r+="?$inlinecount=allpages";GetRequest(r)}}function DisplayProperties(n){$("#searchPropertyValueList").html(n);$("#propertyList").change(function(){var n=$("#propertyList option:selected").attr("data-item");n!=""?($(".idSearchArea").hide(100),n=="Edm.DateTime"?($("#searchPropertySearchValue").datepicker(),$(".filterArea").show(300)):($("#searchPropertySearchValue").datepicker("destroy"),$(".filterArea").show(300))):($(".filterArea").hide(100),$(".idSearchArea").show(100),$("#searchPropertySearchValue").val(""))})}function DisplayNavigationProp(n){for(var r=document.createElement("div"),t,i=0;i<n.length;i++)t=document.createElement("div"),t.className="disabledNavigationElement",t.id="Navigation"+n[i],t.textContent=n[i],t.onclick=function(n){NavigationPropertyClicked(n)},r.appendChild(t);$("#navigationArea").html(r)}function GetCorrectExpandProperty(n,t,i){var r="("+n+")";return t!=undefined&&t!=""&&(r+="/"+t),i?r:r+"?$inlinecount=allpages"}function GetCorrectUrl(n){var t=window.location.host;return n.replace("[server]",t)}function CreateDivHead(){var n=document.createElement("div");return n.className="resultDiv",n}function EnableFormatButton(){$(".showWhenResult").show()}function CreateRequestedUrlLink(n){var t=document.createElement("a"),i;return t.setAttribute("target","_blank"),t.setAttribute("href",n),i=document.createTextNode(n),t.appendChild(i),currentUrl=n,EnableFormatButton(),t}function CreateDivHeadLink(n,t){var o=document.createElement("div"),o=document.createElement("div"),i=document.createElement("div"),r,u,f,e,s;return i.className="nextLink",t!=undefined?(r=document.createElement("i"),r.className="fa fa-backward navigationLink",r.onclick=function(){GetRequest(t)},i.appendChild(r)):(r=document.createElement("i"),r.className="fa fa-backward navigationLinkDisabled",i.appendChild(r)),n!=undefined?(u=document.createElement("i"),u.className="fa fa-forward navigationLink",u.onclick=function(){GetRequest(n)},i.appendChild(u)):(u=document.createElement("i"),u.className="fa fa-forward navigationLinkDisabled",i.appendChild(u)),f=document.createElement("i"),f.className="fa fa-expand expandLink",f.onclick=function(){ExpandResults()},e=document.createElement("i"),e.className="fa fa-link showQueryLink",e.onclick=function(){ShowQueryLink()},s=document.createElement("span"),s.className="queryResultText",i.appendChild(f),i.appendChild(e),i.appendChild(s),o.appendChild(i),o}function CreateTableRow(n,t){var i=document.createElement("div"),r,u,f;return i.className="resultElement",r=document.createElement("div"),r.className="boldColumn",u=document.createElement("div"),u.className="resultElementValue",r.textContent=n,u.textContent=t==undefined||t==""||isWhiteSpace(t)?t!=!1&&t!=!0||isWhiteSpace(t)?isNull(t)?"":"":t:t,i.appendChild(r),i.appendChild(u),f=document.createElement("div"),f.className="clearDiv",i.appendChild(f),i}function isWhiteSpace(n){var t=$.trim(n);return t===""}function isNull(n){return n===null}function CreateObjectRow(n,t){return CreateTableRow(n,t[n])}function GenerateGetNewUrl(n){var t=GenerateDateTimeString(d);return n+("?$inlinecount=allpages&$filter=opdateringsdato%20gt%20datetime'"+t+"'")}function GenerateGetNewFilterUrl(n,t,i,r){return i=="Edm.String"?n+=GetFilterRadioValue()=="Equal"?"?$inlinecount=allpages&$filter="+t+"%20eq%20'"+r+"'":"?$inlinecount=allpages&$filter=substringof('"+r+"',"+t+")%20eq%20true":i=="Edm.Int32"?n+="?$inlinecount=allpages&$filter="+t+"%20eq%20"+r:i=="Edm.Boolean"?n+="?$inlinecount=allpages&$filter="+t+"%20eq%20"+r:i=="Edm.DateTime"&&(n+="?$inlinecount=allpages&$filter=year("+t+") eq "+r.substring(0,4)+" and month("+t+") eq "+parseInt(r.substring(5,7))+" and day("+t+") eq "+parseInt(r.substring(8,10))),n}function CheckKeyValue(n){var t=$("#keyValueToSearch").val()!=undefined&&$("#keyValueToSearch").val()!="";return t?$("#keyValueToSearch").removeClass("errorBorder"):n||$("#keyValueToSearch").addClass("errorBorder"),t}function NavigationPropertyClicked(n){if(CheckKeyValue(n.target.className=="disabledNavigationElement")){var t=n.target.id.replace("Navigation","");n.target.className!="disabledNavigationElement"&&Search(t,"key",!1)}}function GenerateDateTimeString(n){var o=n.getFullYear(),t=n.getMonth(),i,r,u,f,e;return t++,t<10&&(t="0"+t),i=n.getUTCDate(),i<10&&(i="0"+i),r=n.getHours(),r<10&&(r="0"+r),u=n.getMinutes(),u<10&&(u="0"+u),f=n.getSeconds(),f<10&&(f="0"+f),e=n.getMilliseconds(),o+"-"+t+"-"+i+"T"+r+":"+u+":"+f+"."+e}function HandleResultItemContainer(){var t=$(this),n=$("#"+t.parent().attr("id")+"resultItemsContainer"),i=$("#"+n.attr("id")+":visible").length;i==0?n.show(100):n.hide(100)}function HandleResultItemDrillDown(){var n=$(this),t;$("#keyValueToSearch").val(n.attr("data-id"));t=n.attr("data-item");$("#freeSearch option[id="+t+"]").prop("selected",!0);Search(undefined,"key",!0);GetPropertiesForEntity(!1);GetNavigationPropertiesForEntity(!1,!0)}function CreateBackwardLink(n){var f,t;if(n!=undefined&&n!=""){if(f=n.indexOf("skip=")!=-1,t=currentUrl.indexOf("skip=")!=-1,!t||currentUrl.indexOf("skip=0")!=-1)return undefined;var i=currentUrl.length,r=currentUrl.substring(currentUrl.indexOf("skip=")+5,i),u=r-pageSize;return currentUrl.substring(0,currentUrl.indexOf("skip=")+5)+u}if(t=currentUrl.indexOf("skip=")!=-1,t){var i=currentUrl.length,r=currentUrl.substring(currentUrl.indexOf("skip=")+5,i),u=r-pageSize;return currentUrl.substring(0,currentUrl.indexOf("skip=")+5)+u}return undefined}function GenerateRowHTML(n,t,i){var r=document.createElement("div");return r.className="resultRowElement",r.onclick=HandleResultItemContainer,r.innerHTML=i!=undefined&&i!=""?"<div class=resultRowIdentifier>"+n+"<\/div><div class=resultRowTitle>"+i+"<\/span><div class=resultRowDateTime>"+t.substring(0,19).replace("T"," ")+"<\/div>":"<div class=resultRowIdentifier>"+n+"<\/div><div class=resultRowDateTime>"+t.substring(0,19).replace("T"," ")+"<\/div>",r}function GenerateDrillDownElement(n,t){var r=n["odata.metadata"],u=r.indexOf("#"),f=r.substring(u+1),i=document.createElement("div");return i.className="resultRowDrillDownElement",i.setAttribute("data-item",decodeURIComponent(f.replace("/@Element",""))),i.setAttribute("data-id",t),i.setAttribute("title","Navigere videre"),i.onclick=HandleResultItemDrillDown,i.innerHTML='<i class="fa fa-cog"><\/i>',i}function GetResultText(n){var t=n["odata.count"],f,r,u,i,e;return t!=0?(f=t/pageSize,r=Math.ceil(f),n["odata.nextLink"]!=undefined?(u=n["odata.nextLink"],indexOfSkip=u.indexOf("skip="),i=parseInt(u.substring(indexOfSkip+5)),i||(i=0),e=parseInt(i/pageSize),"Viser "+(i-pageSize+1)+" - "+i+" af totalt "+t+" (Side "+e+" af "+r+")"):"Viser "+(t-n.value.length+1)+" - "+t+" af totalt "+t+" (Side "+r+" af "+r+")"):"Viser "+n.value.length+" af "+t}function ExpandResults(){$(".resultItemsContainer").fadeToggle()}function ShowQueryLink(){$(".generatedQueryUrl").is(":visible")?$(".generatedQueryUrl").hide():$(".generatedQueryUrl").show()}function HandleResultCollection(n){var u,t,i,f,r,e;if(d=new Date,$("#dateTimeLastSearch").text(GenerateDateTimeString(d)),$("#ajaxLoader").hide(),HideRequestInformation(),u=CreateDivHead(),u.appendChild(CreateDivHeadLink(n["odata.nextLink"],CreateBackwardLink(n["odata.nextLink"]))),n.value.length!=0)for(t=0;t<n.value.length;t++){i=document.createElement("div");i.setAttribute("id",t);i.className="resultItemsRow";f=GetTitelForData(n,t);i.appendChild(GenerateRowHTML(n.value[t].id,n.value[t].opdateringsdato,f));r=document.createElement("div");r.className="resultItemsContainer";r.setAttribute("id",t+"resultItemsContainer");for(property in n.value[t])property!="odata.metadata"&&(e=CreateObjectRow(property,n.value[t]),r.appendChild(e));r.appendChild(GenerateDrillDownElement(n,n.value[t].id));i.appendChild(r);u.appendChild(i);$(".resultArea").html(u)}else $(".noDataFound").show();$(".queryResultText").text(GetResultText(n))}function CreateWrapperObjectToSingleResult(n){var t={};return t["odata.metadata"]=n["odata.metadata"],t["odata.count"]=1,t.value=[],t.value.push(n),t}function GetRequest(n){$(".resultArea").empty();$(".queryResultText").empty();HideRequestInformation();ShowTheAjaxLoader();$(".theText").html(CreateRequestedUrlLink(n));$.ajax({url:n,type:"GET",dataType:"json",success:function(n){n.value instanceof Array?HandleResultCollection(n):(HandleResultCollection(CreateWrapperObjectToSingleResult(n)),ExpandResults())},error:function(n,t,i){$("#ajaxLoader").hide();n.status!=undefined&&n.status!=""&&(n.status=="404"||n.status=="400")?$(".noDataFound").show():n.status!=undefined&&n.status!=""&&n.status=="500"?$(".errorInApplication").show():$(".queryResultText").text(n.status+" "+i)}})}function GetXMLResponse(n){var t=n+"&$format=xml";window.open(t,"_blank")}function GetJSONResponse(n){window.open(n,"_blank")}function GetTitelForData(n,t){var u=n["odata.metadata"],u=decodeURIComponent(u.replace("/@Element","")),f=u.indexOf("#"),r=u.substring(f+1),i="";return r=="Sag"||r=="Aktstykke"||r=="Debat"||r=="Almdel"||r=="Forslag"?i=n.value[t].titelkort?n.value[t].nummer?n.value[t].nummer+" "+n.value[t].titelkort:n.value[t].titelkort:n.value[t].nummer+" "+n.value[t].titel:r=="Sagskategori"?i=n.value[t].kategori:r=="Sagsstatus"?i=n.value[t].status:r=="Sagstype"?i=n.value[t].type:r=="Sagstrin"?i=n.value[t].titel:r=="Sagstrinsstatus"?i=n.value[t].status:r=="Sagstrinstype"?i=n.value[t].type:r=="Emneord"?i=n.value[t].emneord:r=="Emneordstype"?i=n.value[t].type:r=="SlettetMap"?i=n.value[t].datatype:r=="Dokument"?i=n.value[t].titel:r=="DokumentAktør"?i="Relationen fra Dokument: "+n.value[t].dokumentid+" til Aktør: "+n.value[t].aktørid+" med Rolle: "+n.value[t].rolleid:r=="DokumentAktørRolle"?i=n.value[t].rolle:r=="Dokumentkategori"?i=n.value[t].kategori:r=="Dokumenttype"?i=n.value[t].type:r=="Aktør"?i=n.value[t].gruppenavnkort?n.value[t].gruppenavnkort+" "+n.value[t].navn:n.value[t].navn:r=="Aktørtype"?i=n.value[t].type:r=="Møde"?i=n.value[t].dato+" "+n.value[t].titel:r=="Mødestatus"?i=n.value[t].status:r=="Mødetype"?i=n.value[t].type:r=="Periode"?i=n.value[t].type+" "+n.value[t].kode:r=="SagAktør"?i="Relationen fra Sag: "+n.value[t].sagid+" til Aktør: "+n.value[t].aktørid+" med Rolle: "+n.value[t].rolleid:r=="SagAktørRolle"?i=n.value[t].rolle:r=="AktørAktør"?i="Relationen fra Aktør: "+n.value[t].fraaktørid+" til Aktør: "+n.value[t].tilaktørid+" med Rolle: "+n.value[t].rolleid:r=="AktørAktørRolle"?i=n.value[t].rolle:r=="SagDokument"?i="Relationen mellem Sag: "+n.value[t].sagid+" og Dokument: "+n.value[t].dokumentid+" med Rolle: "+n.value[t].rolleid:r=="SagDokumentRolle"?i=n.value[t].rolle:r=="SagstrinAktør"?i="Relationen mellem Sagstrin: "+n.value[t].sagstrinid+" og Aktør: "+n.value[t].aktørid+" med Rolle: "+n.value[t].rolleid:r=="SagstrinAktørRolle"?i=n.value[t].rolle:r=="KolloneBeskrivelse"?i=n.value[t].entitetnavn+" "+n.value[t].kollonenavn:r=="EntitetBeskrivelse"?i=n.value[t].entitetnavn:r=="MødeAktør"?i="Relationen mellem Møde: "+n.value[t].mødeid+" og Aktør: "+n.value[t].aktørid:r=="EmneordSag"?i="Relationen mellem Emneord: "+n.value[t].emneordid+" og Sag: "+n.value[t].sagid:r=="Dokumentstatus"?i=n.value[t].status:r=="Omtryk"?i=n.value[t].begrundelse:r=="Fil"?i=n.value[t].titel:r=="Dagsordenspunkt"?i=n.value[t].titel:r=="DagsordenspunktDokument"?i="Relationen mellem Dagsordenspunkt: "+n.value[t].dagsordenspunktid+" og Dokument: "+n.value[t].dokumentid:r=="DagsordenspunktSag"?i="Relationen mellem Dagsordenspunkt: "+n.value[t].dagsordenspunktid+" og Sag: "+n.value[t].sagid:r=="Slettet"?i=n.value[t].objektid:r=="Afstemning"?i=n.value[t].nummer+" "+n.value[t].konklusion:r=="Afstemningstype"?i=n.value[t].type:r=="Stemme"?i="Stemme fra aktør: "+n.value[t].aktørid+" på afstemningsid: "+n.value[t].afstemningid:r=="Stemmetype"&&(i=n.value[t].type),i&&i.length>75&&(i=i.substring(0,75)),i}function GetDataFromNavigationProp(){var t=$(".theText").text(),n=[];$(".navigationElement, .disabledNavigationElement").each(function(){n.push($(this).attr("id"))});GetDataFromNavigation(n,t)}function CreateNavigationUrl(n,t){return t=t.replace("?$inlinecount=allpages",""),t+"/"+n}function GetDataFromNavigation(n,t){var i,r;n.length<1||(i=n.pop(),i=i.replace("Navigation",""),r=CreateNavigationUrl(i,t),$.ajax({url:r,type:"GET",success:function(r){r.id!=undefined||r.value!=undefined&&r.value.length>0?($("#Navigation"+i).removeClass("disabledNavigationElement"),$("#Navigation"+i).addClass("navigationElement")):($("#Navigation"+i).removeClass("navigationElement"),$("#Navigation"+i).addClass("disabledNavigationElement"));GetDataFromNavigation(n,t)},error:function(r){r.statusText=="timeout"?($("#Navigation"+i).removeClass("disabledNavigationElement"),$("#Navigation"+i).addClass("navigationElement")):($("#Navigation"+i).removeClass("navigationElement"),$("#Navigation"+i).addClass("disabledNavigationElement"));GetDataFromNavigation(n,t)},timeout:2e3}))}function HideLoader(){$(".startResult").is(":visible")&&$(".startResult").hide();$("#modelAjaxLoader").hide()}function DisplayLoader(n,t){$("#modelAjaxLoader").css("top",parseInt(n)+50+"px");$("#modelAjaxLoader").css("left",parseInt(t)+125+"px");$(".selectedEntity").append($("#modelAjaxLoader").show())}function SelectedEntityHighlight(n){(n=="FraAktørAktør"||n=="TilAktørAktør"||n=="TilAktør"||n=="FraAktør")&&(n="Aktør");(n=="DeltfraSag"||n=="FremsatunderSag"||n=="Sagerdelti"||n=="Sagerfremsatunder")&&(n="Sag");(n=="SpørgsmålsDokumenter"||n=="SpørgsmålsDokument")&&(n="Dokument");(n=="FørsteSagstrin"||n=="AndetSagstrin")&&(n="Sagstrin");$("#entityListItem_"+n).addClass("selectedEntityElement")}function GetTopFromDragg(){return $("#draggMeEnt").css("top")!=undefined?$("#draggMeEnt").css("top"):$("#draggMe").css("top")}function GetLeftFromDragg(){return $("#draggMeEnt").css("left")!=undefined?$("#draggMeEnt").css("left"):$("#draggMe").css("left")}function GetTheEntity(n){var i=GetTopFromDragg(),r=GetLeftFromDragg(),t;DisplayLoader(i.replace("px",""),r.replace("px",""));$(".entityListItem").removeClass("selectedEntityElement");t=BuildBaseUrl()+"/Home/GetDetailOdaModel?name="+n;t=encodeURI(t);$.ajax({url:t,type:"GET",success:function(t){HideLoader();$(".selectedEntityItem").remove();$(".selectedEntity").append(t);$(".selectedEntity").show(300);SelectedEntityHighlight(n);$("#draggMeEnt").draggable({cursor:"move",containment:"window"});$("#draggMeEnt").css("top",i);$("#draggMeEnt").css("left",r)},error:function(){}})}function highlightSelectedMenuItem(n){$(".queryMenuItem").removeClass("queryMenuItemSelected");n.addClass("queryMenuItemSelected")}var d=new Date,pageSize=20,currentUrl;$(document).ready(function(){handleContainerBody();$(window).resize(function(){handleContainerBody()});$("input:radio[value=Equal]").attr("checked",!0);GetPropertiesForEntity(!0);GetNavigationPropertiesForEntity(!0,!1);$("body").keydown(function(n){var t=window.event?n.which:n.keyCode;t==13&&$("#searchButtonFree").focus()});$(".fa-info-circle").mouseover(function(n){var t=$(this).attr("id"),i=n.pageY,r=n.pageX+20;$("."+t+"Info").css({top:i+"px",left:r+"px"});$("."+t+"Info").show()});$(".fa-info-circle").mouseout(function(){var n=$(this).attr("id");$("."+n+"Info").hide()});$("#freeSearch").change(function(){GetPropertiesForEntity(!0);GetNavigationPropertiesForEntity(!0,!1)});$("#newValueToSearch").change(function(){$("#newValueToSearch").is(":checked")?$(".idSearchArea").hide(100):$(".idSearchArea").show(100)});$("#searchButtonFree").click(function(){var n=$("#keyValueToSearch").val()!=undefined&&$("#keyValueToSearch").val()!="",t=$("#searchPropertySearchValue").val()!="",i=$("#newValueToSearch").is(":checked");!n||t||i?Search(undefined,"free",!1):(Search(undefined,"key",!0),GetDataFromNavigationProp())});$("#searchButtonXML").click(function(){var n=$(".theText a").attr("href");GetXMLResponse(n)});$("#searchButtonJSON").click(function(){var n=$(".theText a").attr("href");GetJSONResponse(n)});$("#newMenuItemOdata").click(function(){var n=BuildBaseUrl()+"Home/OdataQuery";window.location.replace(n)});$("#newMenuItemModel").click(function(){var n=BuildBaseUrl()+"Home/OdaModel";window.location.replace(n)});$("#newMenuItemBrowser").click(function(){var n=BuildBaseUrl()+"Home/WebApi";window.location.replace(n)});$(".closeUrl").click(function(){$(".generatedQueryUrl").hide()})});$(document).ready(function(){var n=Math.max(0,($(window).height()-$("#draggMe").outerHeight())/2+$(window).scrollTop()),t=Math.max(0,($(window).width()-$("#draggMe").outerWidth())/2+$(window).scrollLeft());$("#draggMe").css("top","150px");$("#draggMe").css("left","auto");$("#draggMe").draggable({cursor:"move",containment:"window"});$(".entityListItem").click(function(){var n=$(this),t=n.attr("id").replace("entityListItem_","");GetTheEntity(t)});$(".selectedEntity").show()});$(document).ready(function(){$(".expandQuery").show();highlightSelectedMenuItem($("#expand"));$(".queryMenuItem").click(function(){$(".queryContainer").hide();var n=$(this),t=n.attr("id");$("."+t+"Query").show();highlightSelectedMenuItem(n)})})